<!doctype html>
<html >
<head>

    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <!--[if lt IE 9]>
                <script src="http://css3-mediaqueries-js.googlecode.com/svn/trunk/css3-mediaqueries.js"></script>
        <![endif]-->
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="Content-Style-Type" content="text/css" />

    <link href="https://fonts.googleapis.com/css?family=Domine|Montserrat" rel="stylesheet">
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-WskhaSGFgHYWDcbwN70/dfYBj47jz9qbsMId/iRN3ewGhXQFZCSftd1LZCfmhktB" crossorigin="anonymous">
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js" integrity="sha384-smHYKdLADwkXOn1EmN1qk/HfnUcbVRZyYmZ4qpPea6sjB/pTJ0euyQp0Mk8ck+5T" crossorigin="anonymous"></script>
    <!-- <link rel="stylesheet" type="text/css" href="template.css" /> -->
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/diversen/pandoc-bootstrap-adaptive-template@959c3622/template.css" />

    <link href="https://vjs.zencdn.net/5.4.4/video-js.css" rel="stylesheet" />

    <script src="https://code.jquery.com/jquery-2.2.1.min.js"></script>
    <!-- <script type='text/javascript' src='menu/js/jquery.cookie.js'></script> -->
    <!-- <script type='text/javascript' src='menu/js/jquery.hoverIntent.minified.js'></script> -->
    <!-- <script type='text/javascript' src='menu/js/jquery.dcjqaccordion.2.7.min.js'></script> -->
    <!-- <link href="menu/css/skins/blue.css" rel="stylesheet" type="text/css" /> -->
    <!-- <link href="menu/css/skins/graphite.css" rel="stylesheet" type="text/css" /> -->
    <!-- <link href="menu/css/skins/grey.css" rel="stylesheet" type="text/css" /> -->
    <!-- <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script> -->
    <!-- <script src="script.js"></script> -->
    <!-- <script src="jquery.sticky-kit.js "></script> -->
    <script type='text/javascript' src='https://cdn.jsdelivr.net/gh/diversen/pandoc-bootstrap-adaptive-template@959c3622/menu/js/jquery.cookie.js'></script>
    <script type='text/javascript' src='https://cdn.jsdelivr.net/gh/diversen/pandoc-bootstrap-adaptive-template@959c3622/menu/js/jquery.hoverIntent.minified.js'></script>
    <script type='text/javascript' src='https://cdn.jsdelivr.net/gh/diversen/pandoc-bootstrap-adaptive-template@959c3622/menu/js/jquery.dcjqaccordion.2.7.min.js'></script>

    <link href="https://cdn.jsdelivr.net/gh/diversen/pandoc-bootstrap-adaptive-template@959c3622/menu/css/skins/blue.css" rel="stylesheet" type="text/css" />
    <link href="https://cdn.jsdelivr.net/gh/diversen/pandoc-bootstrap-adaptive-template@959c3622/menu/css/skins/graphite.css" rel="stylesheet" type="text/css" />
    <link href="https://cdn.jsdelivr.net/gh/diversen/pandoc-bootstrap-adaptive-template@959c3622/menu/css/skins/grey.css" rel="stylesheet" type="text/css" />
    <link href="https://cdn.jsdelivr.net/gh/ryangrose/easy-pandoc-templates@948e28e5/css/elegant_bootstrap.css" rel="stylesheet" type="text/css" />

    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

    <script src="https://cdn.jsdelivr.net/gh/diversen/pandoc-bootstrap-adaptive-template@959c3622/script.js"></script>

    <script src="https://cdn.jsdelivr.net/gh/diversen/pandoc-bootstrap-adaptive-template@959c3622/jquery.sticky-kit.js"></script>
    <meta name="generator" content="pandoc" />
  <meta name="author" content="Christopher Di Bella" />
  <meta name="date" content="2023-01-29" />
  <title>Applied Modern C++ 8: User-defined types and scope</title>
  <style type="text/css">code{white-space: pre;}</style>
  <style type="text/css">body { font-family: Domine, Georgia, Palatino, 'Palatino Linotype', Times, 'Times New Roman', serif} h1, h2, h3, h4, h5, h6 { font-family: Montserrat, sans }</style>
  <style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #204a87; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #204a87; font-weight: bold; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #ce5c00; font-weight: bold; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="style.css" />
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-HPGZG0F5PP"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-HPGZG0F5PP');
  </script>
  <meta name="keywords" content="C++, cplusplus, cpp, cxx" />
  <meta name="description" content="In this chapter we explore how to build simple types and how scope works." />
</head>
<body>


    <div class="navbar navbar-static-top navbar-expand-sm px-0 pt-0">
    <div class="navbar-inner container-fluid">
      <div class="container">
        <span class="doc-title">Applied Modern C++ 8: User-defined types
and scope</span>
        <ul class="nav pull-right doc-info">
                    <li><p class="navbar-text">Christopher Di
Bella</p></li>
                              <li><p class="navbar-text">2023-01-29</p></li>
                  </ul>
      </div>
    </div>
  </div>
  <div class="container">
      <div class="row">
            <div class="col-12">

      
      <div class="fixed-table">
<div class="table-row-group">
<div class="table-row">
<div class="table-cell">
<a href="applied-modern-cxx-05.html">Chapter 5: Functions</a>
</div>
<div class="table-cell" style="text-align: center;">
<a href="applied-modern-cxx-00.html" target="_blank">Table of
contents</a>
</div>
<div class="table-cell" style="text-align: right;">
<a href="applied-modern-cxx-07.html">Chapter 9: Control flow</a>
</div>
</div>
</div>
</div>
<h1 id="user-defined-types-and-scope">User-defined types and scope</h1>
<p>Since we’ve been placing an emphasis on types and values, it’s
hopefully unsurprising that C++ has ways for programmers to define their
own types. In this instalment, we’ll learn how to define and use our own
types. We’ll then explore some standard library types. Following that,
we’ll learn how scope works in C++, and what that means for objects.</p>
<h2 id="chapter-table-of-contents">Chapter table of contents</h2>
<h2 id="objectives-and-outcomes">Objectives and outcomes</h2>
<table>
<colgroup>
<col style="width: 32%" />
<col style="width: 67%" />
</colgroup>
<thead>
<tr class="header">
<th>Objective (you will develop)</th>
<th>Outcome (you will be able to)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>an understanding of user-defined types and skills in using and
defining them</td>
<td><ul>
<li><em>distinguish</em> user-defined types from built-in types.</li>
<li><em>synthesise</em> enumerations.</li>
<li><em>synthesise</em> simple data structures that have:
<ul>
<li>data members</li>
<li>constructors</li>
<li>member functions</li>
<li>generated comparison operations</li>
</ul></li>
<li><em>identify</em> when to make members public and when to make them
private.</li>
</ul></td>
</tr>
<tr class="even">
<td>skills in using containers</td>
<td><ul>
<li><em>describe</em> what <code>std::vector</code> and
<code>std::map</code> represent.</li>
<li><em>synthesise</em> code that can leverage:
<ul>
<li>inserting, extracting, and erasing elements</li>
<li>counting, finding, and sorting elements</li>
</ul></li>
<li><em>distinguishes</em> between <code>std::string</code> and
<code>std::vector&lt;char&gt;</code>.</li>
</ul></td>
</tr>
<tr class="odd">
<td>an understanding of scope and object lifetime</td>
<td><ul>
<li><em>identify</em> what designates the beginning and end of a
scope.</li>
<li><em>outline</em> what happens to an object once it goes out of
scope.</li>
<li><em>identify</em> unsafe code that permits references to live beyond
the referee’s actual lifetime.</li>
</ul></td>
</tr>
</tbody>
</table>
<h2 id="acknowledgements">Acknowledgements</h2>
<p>Nary a person has reviewed this.</p>
<h2 id="user-defined-types">User-defined types</h2>
<h3 id="data-structures">Data structures</h3>
<p>https://godbolt.org/z/KnE71jeEs</p>
<p>Let’s suppose that we want to write a program that recorded some of
our favourite films. For now, let’s store the film’s title, director,
and composer. In C++, we’re able to make simple record types using the
<code>struct</code> keyword.</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> film <span class="op">{</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="bu">std::</span>string<span class="op"> </span>title<span class="op">;</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="bu">std::</span>string<span class="op"> </span>director<span class="op">;</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="bu">std::</span>string<span class="op"> </span>composer<span class="op">;</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="op">};</span></span></code></pre></div>
<p>After we introduce a struct, we provide it with a name, and then we
open a scope to define the contents of the data structure. In our
<code>film</code> data structure, we have three <em>data members</em>,
all of which are defined using the non-<code>auto</code> syntax (there’s
no way to define a data member using <code>auto</code>). Notice that
we’re also not <code>const</code>-qualifying our members: that causes
issues when we try to do assignment, so we leave the constness for when
we define our objects. Let’s now create a <code>film</code> object:</p>
<div class="sourceCode" id="cb2"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>TEST_CASE<span class="op">(</span><span class="st">&quot;some fun films&quot;</span><span class="op">)</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">auto</span> <span class="at">const</span> star_wars <span class="op">=</span> film<span class="op">{</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span>title <span class="op">=</span> <span class="st">&quot;Star Wars Episode VIII: The Last Jedi&quot;</span><span class="op">,</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span>director <span class="op">=</span> <span class="st">&quot;Johnson, Rian&quot;</span><span class="op">,</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span>composer <span class="op">=</span> <span class="st">&quot;Williams, John&quot;</span><span class="op">,</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="op">};</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>When you want to initialise a <code>film</code> object, you do so by
opening a pair of curly braces and name the elements in the order that
they’re defined in the struct. For example, if we’d try swapping the
title and director, the compiler will complain.</p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> <span class="at">const</span> star_wars <span class="op">=</span> film<span class="op">{</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span>director <span class="op">=</span> <span class="st">&quot;Johnson, Rian&quot;</span><span class="op">,</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span>title <span class="op">=</span> <span class="st">&quot;Star Wars Episode VIII: The Last Jedi&quot;</span><span class="op">,</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span>composer <span class="op">=</span> <span class="st">&quot;Williams, John&quot;</span><span class="op">,</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="op">};</span></span></code></pre></div>
<pre><code>error: ISO C++ requires field designators to be specified in declaration order; field &#39;director&#39; will be initialized after field &#39;title&#39; [-Werror,-Wreorder-init-list]
    .title = &quot;Star Wars Episode VIII: The Last Jedi&quot;,
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
note: previous initialization for field &#39;director&#39; is here
    .director = &quot;Johnson, Rian&quot;,
                ^~~~~~~~~~~~~~~</code></pre>
<p>The <code>.data_member = value</code> syntax is called a
<em>designated initialiser</em>. Designated initialisers are a recent
addition to C++, and so the bulk of production code will use what is
known as <em>list initialisation</em> (you can forget both of these
terms after the chapter ends, but knowing the technical names will make
discussion easier).</p>
<div class="sourceCode" id="cb5"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> <span class="at">const</span> jurassic_park <span class="op">=</span> film<span class="op">{</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Jurassic Park&quot;</span><span class="op">,</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Speilberg, Stephen&quot;</span><span class="op">,</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Williams, John&quot;</span><span class="op">,</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="op">};</span></span></code></pre></div>
<p>List initialisation isn’t nearly as nice as designated initialisers
because it is easy to mix up the parameters. We’re also not allowed to
mix designated initialisers with list initialisation.</p>
<div class="sourceCode" id="cb6"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> <span class="at">const</span> jurassic_park <span class="op">=</span> film<span class="op">{</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Jurassic Park&quot;</span><span class="op">,</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span>director <span class="op">=</span> <span class="st">&quot;Speilberg, Stephen&quot;</span><span class="op">,</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span>composer <span class="op">=</span> <span class="st">&quot;Williams, John&quot;</span><span class="op">,</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="op">};</span></span></code></pre></div>
<pre><code>error: mixture of designated and non-designated initializers in the same initializer list is a C99 extension [-Werror,-Wc99-designator]
    .director = &quot;Speilberg, Stephen&quot;,
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
note: first non-designated initializer is here
    &quot;Jurassic Park&quot;,
    ^~~~~~~~~~~~~~~</code></pre>
<h3 id="enumerations">Enumerations</h3>
<p>Now let’s suppose that we want to also record the medium in which we
can access the films in our catalogue. This data could be stored as a
string, but unless we’re going to record exactly which streaming service
the film is available on, we only need around seven options to store
everything (with “streaming” as a single option). When we have a
countable set of discrete values, we can name them using a <em>scoped
enumeration</em>.</p>
<div class="sourceCode" id="cb8"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">enum</span> <span class="kw">class</span> media_format <span class="op">{</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  vhs<span class="op">,</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  betamax<span class="op">,</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  dvd<span class="op">,</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  dvd_hd<span class="op">,</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  bluray<span class="op">,</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  bluray_4k<span class="op">,</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  digital<span class="op">,</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  online<span class="op">,</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="op">};</span></span></code></pre></div>
<h2 id="containers">Containers</h2>
<h2 id="scope">Scope</h2>
<h2 id="feedback">Feedback</h2>
<p>If you’d like to provide feedback regarding this series, please <a
href="https://github.com/cjdb/cjdb.github.io/issues"
target="_blank">file an issue on GitHub</a>.</p>
<p>If you’re interested in reading future chapters, subscribe to my <a
href="https://blog.cjdb.xyz/feed.xml" target="_blank">RSS feed</a> to
receive a notification at the time of publication. If you’d previously
subscribed to my feed on my old website (www.cjdb.com.au), please be
sure to note the new domain!</p>
<h2 id="summary">Summary</h2>
<div class="fixed-table">
<div class="table-row-group">
<div class="table-row">
<div class="table-cell">
<a href="applied-modern-cxx-05.html">Chapter 5: Functions</a>
</div>
<div class="table-cell" style="text-align: center;">
<a href="applied-modern-cxx-00.html" target="_blank">Table of
contents</a>
</div>
<div class="table-cell" style="text-align: right;">
<a href="applied-modern-cxx-07.html">Chapter 7: Control flow</a>
</div>
</div>
</div>
</div>
            </div>
    </div>
  </div>
  <script src="https://vjs.zencdn.net/5.4.4/video.js"></script>

</body>
</html>
