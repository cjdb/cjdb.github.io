<!doctype html>
<html >
<head>

    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <!--[if lt IE 9]>
                <script src="http://css3-mediaqueries-js.googlecode.com/svn/trunk/css3-mediaqueries.js"></script>
        <![endif]-->
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="Content-Style-Type" content="text/css" />

    <link href="https://fonts.googleapis.com/css?family=Domine|Montserrat" rel="stylesheet">
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-WskhaSGFgHYWDcbwN70/dfYBj47jz9qbsMId/iRN3ewGhXQFZCSftd1LZCfmhktB" crossorigin="anonymous">
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js" integrity="sha384-smHYKdLADwkXOn1EmN1qk/HfnUcbVRZyYmZ4qpPea6sjB/pTJ0euyQp0Mk8ck+5T" crossorigin="anonymous"></script>
    <!-- <link rel="stylesheet" type="text/css" href="template.css" /> -->
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/diversen/pandoc-bootstrap-adaptive-template@959c3622/template.css" />

    <link href="https://vjs.zencdn.net/5.4.4/video-js.css" rel="stylesheet" />

    <script src="https://code.jquery.com/jquery-2.2.1.min.js"></script>
    <!-- <script type='text/javascript' src='menu/js/jquery.cookie.js'></script> -->
    <!-- <script type='text/javascript' src='menu/js/jquery.hoverIntent.minified.js'></script> -->
    <!-- <script type='text/javascript' src='menu/js/jquery.dcjqaccordion.2.7.min.js'></script> -->
    <!-- <link href="menu/css/skins/blue.css" rel="stylesheet" type="text/css" /> -->
    <!-- <link href="menu/css/skins/graphite.css" rel="stylesheet" type="text/css" /> -->
    <!-- <link href="menu/css/skins/grey.css" rel="stylesheet" type="text/css" /> -->
    <!-- <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script> -->
    <!-- <script src="script.js"></script> -->
    <!-- <script src="jquery.sticky-kit.js "></script> -->
    <script type='text/javascript' src='https://cdn.jsdelivr.net/gh/diversen/pandoc-bootstrap-adaptive-template@959c3622/menu/js/jquery.cookie.js'></script>
    <script type='text/javascript' src='https://cdn.jsdelivr.net/gh/diversen/pandoc-bootstrap-adaptive-template@959c3622/menu/js/jquery.hoverIntent.minified.js'></script>
    <script type='text/javascript' src='https://cdn.jsdelivr.net/gh/diversen/pandoc-bootstrap-adaptive-template@959c3622/menu/js/jquery.dcjqaccordion.2.7.min.js'></script>

    <link href="https://cdn.jsdelivr.net/gh/diversen/pandoc-bootstrap-adaptive-template@959c3622/menu/css/skins/blue.css" rel="stylesheet" type="text/css" />
    <link href="https://cdn.jsdelivr.net/gh/diversen/pandoc-bootstrap-adaptive-template@959c3622/menu/css/skins/graphite.css" rel="stylesheet" type="text/css" />
    <link href="https://cdn.jsdelivr.net/gh/diversen/pandoc-bootstrap-adaptive-template@959c3622/menu/css/skins/grey.css" rel="stylesheet" type="text/css" />
    <link href="https://cdn.jsdelivr.net/gh/ryangrose/easy-pandoc-templates@948e28e5/css/elegant_bootstrap.css" rel="stylesheet" type="text/css" />

    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

    <script src="https://cdn.jsdelivr.net/gh/diversen/pandoc-bootstrap-adaptive-template@959c3622/script.js"></script>

    <script src="https://cdn.jsdelivr.net/gh/diversen/pandoc-bootstrap-adaptive-template@959c3622/jquery.sticky-kit.js"></script>
    <meta name="generator" content="pandoc" />
  <meta name="author" content="Christopher Di Bella" />
  <meta name="date" content="2023-01-29" />
  <title>Applied Modern C++ 6: Series Project</title>
  <style type="text/css">code{white-space: pre;}</style>
  <style type="text/css">body { font-family: Domine, Georgia, Palatino, 'Palatino Linotype', Times, 'Times New Roman', serif} h1, h2, h3, h4, h5, h6 { font-family: Montserrat, sans }</style>
  <style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #204a87; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #204a87; font-weight: bold; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #ce5c00; font-weight: bold; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="style.css" />
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-HPGZG0F5PP"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-HPGZG0F5PP');
  </script>
  <meta name="keywords" content="C++, cplusplus, cpp, cxx" />
  <meta name="description" content="This chapter introduces the series' project." />
</head>
<body>


    <div class="navbar navbar-static-top navbar-expand-sm px-0 pt-0">
    <div class="navbar-inner container-fluid">
      <div class="container">
        <span class="doc-title">Applied Modern C++ 6: Series
Project</span>
        <ul class="nav pull-right doc-info">
                    <li><p class="navbar-text">Christopher Di
Bella</p></li>
                              <li><p class="navbar-text">2023-01-29</p></li>
                  </ul>
      </div>
    </div>
  </div>
  <div class="container">
      <div class="row">
            <div class="col-12">

      
      <div class="fixed-table">
<div class="table-row-group">
<div class="table-row">
<div class="table-cell">
<a href="applied-modern-cxx-05.html">Chapter 5: Functions</a>
</div>
<div class="table-cell" style="text-align: center;">
<a href="applied-modern-cxx-00.html" target="_blank">Table of
contents</a>
</div>
<div class="table-cell" style="text-align: right;">
<a href="applied-modern-cxx-07.html">Chapter 7: Lexical analysis</a>
</div>
</div>
</div>
</div>
<h1 id="series-project">Series Project</h1>
<p>Throughout this series, we’re going to be implementing a BF compiler.
This chapter introduces you to both a high-level overview of a compiler
and to the BF language. As a result, we won’t be learning anything about
C++ in this chapter (but everything we learn will be relevant to the
next chapter). It’s okay to not get this chapter on the first go: we’ll
be implementing the compiler over a great many chapters, so feel free to
refer to this chapter as often as necessary.</p>
<p>Compilers are a fun<a href="#fn1" class="footnote-ref" id="fnref1"
role="doc-noteref"><sup>1</sup></a> technology to implement and require
a wide variety of data structures and algorithms. Although we won’t be
implementing part of the compiler in every chapter, we will be using it
as a common and practical motivation, so that you can observe how
features are used in a context that isn’t contrived and needs some
design.</p>
<h2 id="chapter-table-of-contents">Chapter table of contents</h2>
<ol type="1">
<li><a href="#series-project">Series Project</a>
<ol type="1">
<li><a href="#chapter-table-of-contents">Chapter table of
contents</a></li>
<li><a href="#objectives-and-outcomes">Objectives and outcomes</a></li>
<li><a href="#acknowledgements">Acknowledgements</a></li>
<li><a href="#an-overview-of-compilers">An overview of compilers</a>
<ol type="1">
<li><a href="#front-end">Front-end</a>
<ol type="1">
<li><a href="#front-end-phase-1-lexical-analysis">Front-end phase 1:
lexical analysis</a></li>
<li><a href="#front-end-phase-2-parsing">Front-end phase 2:
parsing</a></li>
<li><a href="#front-end-phase-3-semantic-analysis">Front-end phase 3:
semantic analysis</a></li>
</ol></li>
<li><a href="#back-end">Back-end</a>
<ol type="1">
<li><a href="#back-end-phase-1-optimisation-optional">Back-end phase 1:
optimisation (optional)</a></li>
<li><a href="#back-end-phase-2-code-generation">Back-end phase 2: code
generation</a></li>
</ol></li>
<li><a href="#intermediate-representation">Intermediate
representation</a></li>
<li><a href="#further-reading">Further reading</a></li>
</ol></li>
<li><a href="#bf">BF</a>
<ol type="1">
<li><a href="#what-is-bf">What is BF?</a></li>
<li><a
href="#does-this-mean-ill-need-to-learn-how-to-program-in-bf-too">Does
this mean I’ll need to learn how to program in BF too?</a></li>
<li><a href="#memory-model">Memory model</a></li>
<li><a href="#instruction-set">Instruction set</a></li>
</ol></li>
<li><a href="#feedback">Feedback</a></li>
<li><a href="#summary">Summary</a></li>
</ol></li>
</ol>
<h2 id="objectives-and-outcomes">Objectives and outcomes</h2>
<table>
<colgroup>
<col style="width: 32%" />
<col style="width: 67%" />
</colgroup>
<thead>
<tr class="header">
<th>Objective (you will develop)</th>
<th>Outcome (you will be able to)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>an understanding of how a compiler translates source code into
target code</td>
<td><ul>
<li><em>identify</em> the three major components of a compiler.</li>
<li><em>describe</em> the five main compiler passes:
<ul>
<li>scanning, parsing, semantic analysis, optimisation, and code
generation.</li>
</ul></li>
<li><em>explain</em> why an intermediate representation plays a key
component in the design of a compiler.</li>
</ul></td>
</tr>
<tr class="even">
<td>an understanding of the rules of the BF programming language</td>
<td><ul>
<li><em>describe</em> the language’s memory model.</li>
<li><em>describe</em> the language’s “architecture”.</li>
<li><em>identify</em> all eight instructions.</li>
<li><em>identify</em> comment characters.</li>
</ul></td>
</tr>
</tbody>
</table>
<h2 id="acknowledgements">Acknowledgements</h2>
<p>Thanks to <a href="https://github.com/tfpk" target="_blank">Tom
Kunc</a>, Janet Cobb, David Ledger, <a href="https://dippedrusk.com/"
target="_blank">Vagrant Gautam</a>, <a href="https://chandlerc.blog"
target="_blank">Chandler Carruth</a>, <a
href="https://github.com/killerbee13" target="_blank">killerbee13</a>,
Kate Gregory, Luke D’Alessandro, Corentin Jabot, and John Filleau for
their feedback on this chapter.</p>
<h2 id="an-overview-of-compilers">An overview of compilers</h2>
<p>You may recall from <a
href="applied-modern-cxx-02.html#c-is-a-compiled-language"
target="_blank">Chapter 2</a> that a compiler is a program that
translates a program written in one language into an equivalent program
in another language. Compilers are typically comprised of three parts: a
front-end, an optional middle-end, and a back-end. <em>Applied Modern
C++</em> isn’t a book on compilers, so we’ll sadly be skipping over a
lot of interesting compiler theory. This chapter will give you an
overview of these three parts, and then we’ll go into more detail about
each part—along with a design—prior to implementing them in C++.</p>
<p>A compiler must preserve the meaning of its input, otherwise it
wouldn’t make for a useful tool.</p>
<h3 id="front-end">Front-end</h3>
<p>The front-end is responsible for reading the input (called the
<em>source program</em>), understanding its meaning, and diagnosing any
problems with the program. Since the front-end needs knowledge of the
language it’s reading, it is very source-language specific. The
front-end is broken down further into three distinct phases.</p>
<h4 id="front-end-phase-1-lexical-analysis">Front-end phase 1: lexical
analysis</h4>
<p>The first pass is called <a
href="https://en.wikipedia.org/wiki/Lexical_analysis"
target="_blank">lexical analysis</a>, or scanning. The scanner directly
reads the source, groups characters into meaningful symbols called
<em>tokens</em>, and then feeds this information to the next pass. You
can think of this step like reading individual words and punctuation,
and then categorising them as nouns, adjectives, verbs, punctuation,
etc.. For example, the sentence “Failure is the greatest teacher.” has
six tokens. A simple scanner might tokenise them as follows:</p>
<pre><code>&lt;kind = noun,      spelling = &quot;Failure&quot;,  position = 1&gt;
&lt;kind = verb,      spelling = &quot;is&quot;,       position = 2&gt;
&lt;kind = article,   spelling = &quot;the&quot;,      position = 3&gt;
&lt;kind = adjective, spelling = &quot;greatest&quot;, position = 4&gt;
&lt;kind = noun,      spelling = &quot;teacher&quot;,  position = 5&gt;
&lt;kind = full stop, spelling = &quot;.&quot;,        position = 6&gt;</code></pre>
<p>The next chapter will cover lexical analysis in more detail as we
will be writing a scanner to motivate the remaining C++ chapters for
this module.</p>
<h4 id="front-end-phase-2-parsing">Front-end phase 2: parsing</h4>
<p>The second pass is called <a
href="https://en.wikipedia.org/wiki/Parsing" target="_blank">syntax
analysis</a>, or parsing. The parser is responsible for checking the
program’s structure is correct according to a <a
href="https://en.wikipedia.org/wiki/Formal_grammar"
target="_blank">grammar</a>. Unlike natural languages, which have
flexible grammars, programming languages need to have a rigid grammar to
help ensure that there aren’t any ambiguities in a program: it won’t be
feasible for the compiler to ask for clarification. Here’s an incredibly
simplified grammar for a sentence in English<a href="#fn2"
class="footnote-ref" id="fnref2"
role="doc-noteref"><sup>2</sup></a>.</p>
<pre><code>sentence  = subject verb object endmark
endmark   = &quot;.&quot; | &quot;!&quot;
subject   = article? adjective? noun
object    = article? adjective? noun
article   = &quot;the&quot; | &quot;an&quot; | &quot;a&quot;</code></pre>
<p><code>adjective</code>, <code>noun</code>, and <code>verb</code> have
their usual meanings. <code>endmark</code> uses <code>|</code> to
indicate alternatives: it’s either a full stop or an exclamation mark.
<code>subject</code> and <code>object</code> use <code>?</code> to
indicate something is optional: an article <em>may</em> be present, but
it doesn’t need to be. This grammar is compatible with the token stream
from our hypothetical scanner. Now suppose we tokenise “The greatest
teacher failure is.” Will this be a valid <code>sentence</code>?</p>
<pre><code>&lt;kind = article,   spelling = &quot;The&quot;,      position = 1&gt;
&lt;kind = adjective, spelling = &quot;greatest&quot;, position = 2&gt;
&lt;kind = noun,      spelling = &quot;teacher&quot;,  position = 3&gt;
&lt;kind = noun,      spelling = &quot;failure&quot;,  position = 4&gt;
&lt;kind = verb,      spelling = &quot;is&quot;,       position = 5&gt;
&lt;kind = full stop, spelling = &quot;.&quot;,        position = 6&gt;</code></pre>
<p>If we expand <code>sentence</code>, we can—on inspection—identify why
“The greatest teacher failure is” is considered an invalid sentence by
our parser.</p>
<pre><code>//               subject expanded               object expanded
sentence = (article? adjective? noun) verb (article? adjective? noun) endmark</code></pre>
<p>Notice that we have two consectuive nouns in our second token stream,
and that our grammar requires nouns to be split by a verb. As a result
of this, the parser will issue a syntax error.</p>
<h4 id="front-end-phase-3-semantic-analysis">Front-end phase 3: semantic
analysis</h4>
<p>Once this stage is completed, the parser will hand over to the third
pass, for <a
href="https://en.wikipedia.org/wiki/Semantic_analysis_(compilers)"
target="_blank">semantic analysis</a>. The semantic analyser checks that
the program’s meaning is correct. This is often concerned with checking
things that aren’t expressible in the grammar. For example, the sentence
“The colourless idea is a wooden happiness” is a valid
<code>sentence</code> according to the parser, but it fails semantic
analysis because ideas don’t have colour, and because ideas don’t
express emotions such as happiness<a href="#fn3" class="footnote-ref"
id="fnref3" role="doc-noteref"><sup>3</sup></a>.</p>
<p>The semantic analyser is also responsible for
<em>canonicalisation</em>, which transforms the program so that <a
href="https://en.wikipedia.org/wiki/Idempotence#Computer_science_meaning"
target="_blank">idempotent expressions</a> are all expressed in the same
way. For example, there are many ways to ask about the colour of a ball.
Here are just a few:</p>
<blockquote>
<p>Is the ball red or blue?</p>
<p>Is the ball red, or is it blue?</p>
<p>Is the ball blue, or is it red?</p>
<p>Is the ball red in colour, or blue in colour?</p>
</blockquote>
<p>These are all asking the same question, so we pick one of the
phrasings, and turn all other phrasings with the same meaning into that
one. This is important for keeping intermediate representations simple,
which we’ll look at later on.</p>
<h3 id="back-end">Back-end</h3>
<p>Once the compiler established that the source program is correct and
translatable, it needs to actually do said translation. The back-end is
responsible for producing an output (called the <em>target
program</em>). Similar to how the source program was written in a source
language, the target program is written in a target language. For the
purposes of this chapter, we’ll split the back-end into two main
phases.</p>
<h4 id="back-end-phase-1-optimisation-optional">Back-end phase 1:
optimisation (optional)</h4>
<p>Source code is a tool used to communicate with humans and computers,
and we should always be striving to write code that is correct first,
easy-to-understand second, and efficient third. The <a
href="https://en.wikipedia.org/wiki/Program_optimization"
target="_blank">optimiser’s</a> role in translation is to take our
readable code and make it more “efficient”. This could mean that the
code is made faster, smaller, more power-efficient, or some combination
of the three. For example, the following code is a questionable—but
valid—way to set an integer to 5:</p>
<div class="sourceCode" id="cb5"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> x <span class="op">=</span> zero<span class="op">();</span> <span class="co">// x == 0</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="op">++</span>x<span class="op">;</span> <span class="co">// x == 1</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="op">++</span>x<span class="op">;</span> <span class="co">// x == 2</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="op">++</span>x<span class="op">;</span> <span class="co">// x == 3</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="op">++</span>x<span class="op">;</span> <span class="co">// x == 4</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="op">++</span>x<span class="op">;</span> <span class="co">// x == 5</span></span></code></pre></div>
<p>If the compiler were to faithfully translate this code, it would be
quite slow due to the repeated increments. The optimiser would step in
and change it to <code>auto x = zero() + 5</code>. If it can prove that
<code>zero()</code> always returns <code>0</code>, then it is allowed to
simplify it further, to simply <code>auto x = 5;</code>.</p>
<h4 id="back-end-phase-2-code-generation">Back-end phase 2: code
generation</h4>
<p>The last thing that the back-end will need to do is to produce the
target program itself. We call this <em><a
href="https://en.wikipedia.org/wiki/Code_generation_(compiler)"
target="_blank">code generation</a></em>. Compilers are often associated
with generating assembly as their target program, though many will also
generate some high-level source code as well. The code generator has
expert knowledge about its target language, and uses this expertise to
generate the best possible target program given the information it’s
provided with.</p>
<h3 id="intermediate-representation">Intermediate representation</h3>
<p>Linux is designed to work on many different kinds of platforms:
various distributions can run on <a
href="https://en.wikipedia.org/wiki/X86-64" target="_blank">x86-64</a>
(desktops/laptops/servers), <a
href="https://en.wikipedia.org/wiki/ARM_architecture_family#32-bit_architecture"
target="_blank">ARMv7</a> (mobile phones/some laptops/servers), <a
href="https://en.wikipedia.org/wiki/ARM_architecture_family#Armv8"
target="_blank">ARMv8</a> (ditto), and <a
href="https://en.wikipedia.org/wiki/MIPS_architecture"
target="_blank">MIPS</a> (older gaming consoles), just to name a few. If
we were to write a C++ compiler for each of these platforms with the
workflow described above, we’d have to write out four C++ compilers (one
for each platform). If we also want a Rust compiler, we’ll need to write
another four, and another four to add a Swift compiler, and another four
to add a C compiler (we require sixteen separate codebases now). If we
plan to support the <a href="https://en.wikipedia.org/wiki/RISC-V"
target="_blank">RISC-V</a> chipset, we’ll need to do that for all of the
languages, bringing us to 20 codebases. This results in a <a
href="https://en.wikipedia.org/wiki/Combinatorial_explosion"
target="_blank">combinatorial explosion</a>: if we wish to support <span
class="math inline"><em>L</em></span>  languages and <span
class="math inline"><em>P</em></span>  platforms, we’re going to need to
write <span class="math inline"><em>L</em> ⋅ <em>P</em></span> 
compilers. That’s untenable!</p>
<p>Good software engineering practices allow us to avoid this problem by
decoupling the front-end and the back-end. Recall that the front-end is
an expert in the source language, and the back-end is an expert in the
target language. Neither of them have <em>any</em> knowledge of the
other, so we can put them into completely different modules. This means
that there will be <em>one</em> front-end for each language and
<em>one</em> back-end for each of the platforms we support. That reduces
the number of components that we need to write from <span
class="math inline"><em>L</em>  ⋅ <em>P</em></span>  down to <span
class="math inline"><em>L</em>  + <em>P</em></span>. In our hypothetical
scenario, this means that we’d write a total of four front-ends and five
back-ends: then we plug them together to create our set of 20
compilers.</p>
<p>In order to facilitate this <a
href="https://en.wikipedia.org/wiki/Separation_of_concerns"
target="_blank">separation of concerns</a>, we need a way for the two
components to talk with one another. This is called the <em><a
href="https://en.wikipedia.org/wiki/Intermediate_representation"
target="_blank">intermediate representation</a></em>. An intermediate
representation is a data structure that serves as the glue between two
different components, by offering an interface that both parties
understand. There are many different kinds of intermediate
representations that compilers use. We’ll explore this in some detail
later on, but won’t need to get into the specifics terribly much for our
own purposes.</p>
<p>This may seem like a tangent, but the idea of an intermediate
representation comes up a <em>lot</em> in C++, and so it’s worth taking
some time out to get an understanding of the concept.</p>
<h3 id="further-reading">Further reading</h3>
<p>Since we’re not going to be exploring compilers in detail, you may
wish to read <a
href="https://www.oreilly.com/library/view/engineering-a-compiler/9780080916613/"
target="_blank">Engineering a Compiler</a> if you find this project
interesting.</p>
<p>We’re about to take a hard context switch into learning about the toy
language we’ll be implementing, so now is a probably a good time to
stretch your legs, grab a glass of water, and then read on.</p>
<h2 id="bf">BF</h2>
<h3 id="what-is-bf">What is BF?</h3>
<p>BF<a href="#fn4" class="footnote-ref" id="fnref4"
role="doc-noteref"><sup>4</sup></a> is an <a
href="https://en.wikipedia.org/wiki/Esoteric_programming_language"
target="_blank">esoteric programming language</a> that’s
<em>extremely</em> simple to implement, with only eight instructions.
Due to this simplicity, BF is a popular language for implementing simple
language translators.</p>
<h3 id="does-this-mean-ill-need-to-learn-how-to-program-in-bf-too">Does
this mean I’ll need to learn how to program in BF too?</h3>
<p>No! You don’t need to know how to write programs in BF in order to
complete this project. We’ll be using examples online (such as those
found on Wikipedia) as our test programs. All that you need to learn are
how the memory model and the instruction set work, so that you can
translate the source code to target code.</p>
<h3 id="memory-model">Memory model</h3>
<p>BF programs have an array of at least 30kB readable and writable
memory at their disposal, and an index to tell us where in the array
we’re currently reading/writing. At program start, all of the values in
the array are zero. Since that’s quite a lot of cells, we won’t visually
represent it like we usually do: we’ll instead refer to the memory as
<code>data[data_index]</code>.</p>
<h3 id="instruction-set">Instruction set</h3>
<p>As previously mentioned, BF has only eight instructions, which reside
in an instruction cache, which is indexed too. We’ll call this
<code>instructions[instruction_index]</code>. After executing the
instruction at <code>instruction[instruction_index]</code>, we increment
the instruction index.</p>
<table>
<colgroup>
<col style="width: 12%" />
<col style="width: 87%" />
</colgroup>
<thead>
<tr class="header">
<th>Character</th>
<th>Instruction</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>&gt;</code></td>
<td><code>++data_index</code></td>
</tr>
<tr class="even">
<td><code>&lt;</code></td>
<td><code>--data_index</code></td>
</tr>
<tr class="odd">
<td><code>+</code></td>
<td><code>++data[data_index]</code></td>
</tr>
<tr class="even">
<td><code>-</code></td>
<td><code>--data[data_index]</code></td>
</tr>
<tr class="odd">
<td><code>.</code></td>
<td><code>fmt::print(data[data_index])</code></td>
</tr>
<tr class="even">
<td><code>,</code></td>
<td>Reads input from the user.</td>
</tr>
<tr class="odd">
<td><code>[</code></td>
<td>If <code>data[data_index] == 0</code>: set
<code>instruction_index</code> to the index of the matching
<code>]</code> + <code>1</code> (see below).</td>
</tr>
<tr class="even">
<td><code>]</code></td>
<td>If <code>data[data_index] != 0</code>: set
<code>instruction_index</code> to the index of the matching
<code>[</code> + <code>1</code> (see below).</td>
</tr>
</tbody>
</table>
<p>Any character that isn’t an instruction is a comment.</p>
<p>Every <code>[</code> must be matched with a following <code>]</code>,
and vice versa. This means that <code>[</code>, <code>[[]</code>,
<code>]</code>, <code>[]]</code>, and <code>][</code> are all invalid
programs, because sometimes the brackets aren’t balanced, and sometimes
they’re in the wrong order. <code>[[]]</code> on the other hand, would
be valid.</p>
<p>This is everything you need to know about BF in order to complete the
project!</p>
<h2 id="feedback">Feedback</h2>
<p>If you’d like to provide feedback regarding this series, please <a
href="https://github.com/cjdb/cjdb.github.io/issues"
target="_blank">file an issue on GitHub</a>.</p>
<p>If you’re interested in reading future chapters, subscribe to my <a
href="https://blog.cjdb.xyz/feed.xml" target="_blank">RSS feed</a> to
receive a notification at the time of publication. If you’d previously
subscribed to my feed on my old website (www.cjdb.com.au), please be
sure to note the new domain!</p>
<h2 id="summary">Summary</h2>
<p>In this chapter, we learnt about the five main phases that compilers
enact, how they’re categorised, and what is used to facilitate their
separation. Finally, we learnt about our project’s source language. As
teased earlier on, we’re going to look at lexical analysis more closely
in the next chapter, since it will directly relevant to everything left
in the module. After that, it’s back to C++!</p>
<div class="fixed-table">
<div class="table-row-group">
<div class="table-row">
<div class="table-cell">
<a href="applied-modern-cxx-05.html">Chapter 5: Functions</a>
</div>
<div class="table-cell" style="text-align: center;">
<a href="applied-modern-cxx-00.html" target="_blank">Table of
contents</a>
</div>
<div class="table-cell" style="text-align: right;">
<a href="applied-modern-cxx-07.html">Chapter 7: Lexical analysis</a>
</div>
</div>
</div>
</div>
<section id="footnotes" class="footnotes footnotes-end-of-document"
role="doc-endnotes">
<hr />
<ol>
<li id="fn1"><p>As a compiler engineer, I’m slightly biased on the fun
part, but the broadness is fairly objective.<a href="#fnref1"
class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>I really need to stress that this is a
<em>simplified</em> grammar, and that anyone with a background in
linguistics will notice that it allows for many invalid sentences in a
real-world setting (e.g. “C++ is fun language”). Vagrant—one of my
reviewers—is a linguist and was able to identify many problems with the
syntax (some of which I wasn’t even aware of). Writing a true set of
rules for natural languages is not the done thing anymore, and that’s
way beyond the scope of this book (when I asked for further reading
material, I was told that it can probably fill an entire course).<a
href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>There’s also an argument that happiness can’t be
“wooden”, although having “wooden enthusiasm” implies that someone is
feigning their emotion, and I think that might apply to happiness too.<a
href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>The full name of BF contains strong language, which may
cause some folks distress to the point of not reading the text. In order
to be as inclusive as possible, while still using this very simple
language, I’m using the shorthand “BF” instead. If you’d like to read
more about the language, you can do so on <a
href="https://en.wikipedia.org/wiki/Brainfuck"
target="_blank">Wikipedia</a>, but please be aware that it uses the
unabbreviated name in the article.<a href="#fnref4"
class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>
            </div>
    </div>
  </div>
  <script src="https://vjs.zencdn.net/5.4.4/video.js"></script>

</body>
</html>
